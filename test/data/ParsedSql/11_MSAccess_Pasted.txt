<SqlRoot><SqlStatement><Clause><DDLDeclareBlock><OtherKeyword>DECLARE</OtherKeyword><WhiteSpace> </WhiteSpace><Other>@FileName</Other><WhiteSpace> </WhiteSpace><DataTypeKeyword>nvarchar</DataTypeKeyword><DDLDetailParens><NumberValue>50</NumberValue></DDLDetailParens><Comma>,</Comma><WhiteSpace>
			</WhiteSpace><Other>@MerchantID</Other><WhiteSpace> </WhiteSpace><DataTypeKeyword>INT</DataTypeKeyword><Comma>,</Comma><WhiteSpace>
			</WhiteSpace><Other>@ShippingCompanyID</Other><WhiteSpace> </WhiteSpace><DataTypeKeyword>Int</DataTypeKeyword><WhiteSpace>
</WhiteSpace></DDLDeclareBlock></Clause></SqlStatement><SqlStatement><Clause><OtherKeyword>SELECT</OtherKeyword><WhiteSpace> </WhiteSpace><Asterisk>*</Asterisk><WhiteSpace>
</WhiteSpace></Clause><Clause><OtherKeyword>FROM</OtherKeyword><SelectionTarget><WhiteSpace>
</WhiteSpace><SelectionTargetParens><ExpressionParens><Clause><OtherKeyword>SELECT</OtherKeyword><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>ShippingCompany</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>Filename</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>ItemCode</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>Buyer</Other><Period>.</Period><Other>Country</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><FunctionKeyword>Sum</FunctionKeyword><FunctionParens><Other>OrderItem</Other><Period>.</Period><Other>Quantity</Other></FunctionParens><WhiteSpace> </WhiteSpace><OtherKeyword>As</OtherKeyword><WhiteSpace> </WhiteSpace><Other>Quantity</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><FunctionKeyword>Avg</FunctionKeyword><FunctionParens><Other>OrderItem</Other><Period>.</Period><Other>Price</Other></FunctionParens><WhiteSpace> </WhiteSpace><OtherKeyword>As</OtherKeyword><WhiteSpace> </WhiteSpace><Other>Price</Other><WhiteSpace>    </WhiteSpace></Clause><Clause><OtherKeyword>FROM</OtherKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><WhiteSpace> </WhiteSpace></SelectionTarget></Clause><Clause><CompoundKeyword simpleText="LEFT JOIN"><OtherKeyword>LEFT</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>Buyer</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>Buyer</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>Buyer</Other><Period>.</Period><Other>BuyerNumber</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>BuyerNumber</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>SH</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>SHCode</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>SHCode</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>Shipper</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>Shipper</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>ShipperID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>Shipper</Other><Period>.</Period><Other>ShipperID</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><OtherKeyword>WHERE</OtherKeyword><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>ShipperID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@ShippingCompanyID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><OtherKeyword>Is</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>Null</OtherKeyword><WhiteSpace> </WhiteSpace></Clause><Clause><OtherKeyword>GROUP</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>BY</OtherKeyword><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>ShippingCompany</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>Filename</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>ItemCode</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>Buyer</Other><Period>.</Period><Other>Country</Other><WhiteSpace> </WhiteSpace></Clause><Clause><OtherKeyword>HAVING</OtherKeyword><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>Filename</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@FileName</Other></Clause></ExpressionParens><WhiteSpace> </WhiteSpace><Clause><SetOperatorClause><OtherKeyword>UNION</OtherKeyword></SetOperatorClause><WhiteSpace> 
 </WhiteSpace></Clause><Clause><SelectionTargetParens><Clause><OtherKeyword>SELECT</OtherKeyword><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>ShippingCompany</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>Filename</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>ItemCode</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>Country</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><FunctionKeyword>Sum</FunctionKeyword><FunctionParens><Other>OrderItem</Other><Period>.</Period><Other>Quantity</Other></FunctionParens><WhiteSpace> </WhiteSpace><OtherKeyword>As</OtherKeyword><WhiteSpace> </WhiteSpace><Other>Quantity</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><FunctionKeyword>Avg</FunctionKeyword><FunctionParens><Other>OrderItem</Other><Period>.</Period><Other>Price</Other></FunctionParens><WhiteSpace> </WhiteSpace><OtherKeyword>As</OtherKeyword><WhiteSpace> </WhiteSpace><Other>Price</Other><WhiteSpace> </WhiteSpace></Clause><Clause><OtherKeyword>FROM</OtherKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><WhiteSpace> </WhiteSpace></SelectionTarget></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>OrderNumber</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>SH</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>SHCode</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>OrderHeader</Other><Period>.</Period><Other>SHCode</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>Shipper</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>Shipper</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>ShipperID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>Shipper</Other><Period>.</Period><Other>ShipperID</Other><WhiteSpace> </WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><OtherKeyword>WHERE</OtherKeyword><WhiteSpace> </WhiteSpace><Other>SH</Other><Period>.</Period><Other>ShipperID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@ShippingCompanyID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@MerchantID</Other><WhiteSpace> </WhiteSpace></Clause><Clause><OtherKeyword>GROUP</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>BY</OtherKeyword><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>MerchantID</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>ShippingCompany</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>Filename</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>ItemCode</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>OrderShippingAddress</Other><Period>.</Period><Other>Country</Other><WhiteSpace> </WhiteSpace></Clause><Clause><OtherKeyword>HAVING</OtherKeyword><WhiteSpace> </WhiteSpace><Other>OrderItem</Other><Period>.</Period><Other>Filename</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@FileName</Other></Clause></SelectionTargetParens></Clause></SelectionTargetParens><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><WhiteSpace> 
</WhiteSpace></SelectionTarget></Clause><Clause><CompoundKeyword simpleText="INNER JOIN"><OtherKeyword>INNER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>JOIN</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>Item</Other><WhiteSpace> </WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>ON</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>Item</Other><Period>.</Period><Other>MerchantID</Other><WhiteSpace> </WhiteSpace><And><OtherKeyword>AND</OtherKeyword></And><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>ItemCode</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>Item</Other><Period>.</Period><Other>ItemCode</Other><WhiteSpace> 
</WhiteSpace></ContainerContentBody></JoinOn></Clause><Clause><OtherKeyword>GROUP</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>BY</OtherKeyword><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>ShippingCompany</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>Country</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>ItemCode</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>Item</Other><Period>.</Period><Other>ProductName</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>Weight</Other><WhiteSpace> </WhiteSpace></Clause><Clause><OtherKeyword>ORDER</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>BY</OtherKeyword><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>Country</Other><Comma>,</Comma><WhiteSpace> </WhiteSpace><Other>SubQuery</Other><Period>.</Period><Other>ItemCode</Other><WhiteSpace> 
</WhiteSpace></Clause></SqlStatement></SqlRoot>