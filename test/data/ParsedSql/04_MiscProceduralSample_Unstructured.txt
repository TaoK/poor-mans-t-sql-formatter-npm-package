<SqlRoot><SqlStatement><Clause><DDLOtherBlock><OtherKeyword>Create</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>Table</OtherKeyword><WhiteSpace> </WhiteSpace><Other>#ValueTable</Other><WhiteSpace> </WhiteSpace><DDLParens><Other>Id</Other><WhiteSpace> </WhiteSpace><DataTypeKeyword>nvarchar</DataTypeKeyword><DDLDetailParens><NumberValue>5</NumberValue></DDLDetailParens></DDLParens><WhiteSpace>
</WhiteSpace></DDLOtherBlock></Clause></SqlStatement><SqlStatement><Clause><DDLDeclareBlock><OtherKeyword>declare</OtherKeyword><WhiteSpace> </WhiteSpace><Other>@MonthIDs</Other><WhiteSpace> </WhiteSpace><DataTypeKeyword>nvarchar</DataTypeKeyword><DDLDetailParens><NumberValue>4000</NumberValue></DDLDetailParens><WhiteSpace>
</WhiteSpace></DDLDeclareBlock></Clause></SqlStatement><SqlStatement><Clause><DDLDeclareBlock><OtherKeyword>declare</OtherKeyword><WhiteSpace> </WhiteSpace><Other>@WorkingString</Other><WhiteSpace> </WhiteSpace><OtherKeyword>AS</OtherKeyword><WhiteSpace> </WhiteSpace><DataTypeKeyword>nvarchar</DataTypeKeyword><DDLDetailParens><NumberValue>4000</NumberValue></DDLDetailParens><WhiteSpace>
</WhiteSpace></DDLDeclareBlock></Clause></SqlStatement><SqlStatement><Clause><OtherKeyword>select</OtherKeyword><WhiteSpace> </WhiteSpace><Other>@MonthIDs</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><String>3,5,6,8,11</String><WhiteSpace>
</WhiteSpace></Clause></SqlStatement><SqlStatement><Clause><OtherKeyword>select</OtherKeyword><WhiteSpace> </WhiteSpace><Other>@WorkingString</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>@MonthIDs</Other><WhiteSpace>
</WhiteSpace></Clause></SqlStatement><SqlStatement><Clause><WhileLoop><ContainerOpen><OtherKeyword>WHILE</OtherKeyword></ContainerOpen><BooleanExpression><WhiteSpace> </WhiteSpace><FunctionKeyword>len</FunctionKeyword><FunctionParens><Other>@WorkingString</Other></FunctionParens><WhiteSpace> </WhiteSpace><OtherOperator>&gt;</OtherOperator><WhiteSpace> </WhiteSpace><NumberValue>0</NumberValue><WhiteSpace>
</WhiteSpace></BooleanExpression><ContainerSingleStatementBody><SqlStatement><Clause><BeginEndBlock><ContainerOpen><OtherKeyword>BEGIN</OtherKeyword></ContainerOpen><ContainerMultiStatementBody><SqlStatement><WhiteSpace> 
</WhiteSpace><SingleLineComment>Printing the current temp string and the position of the first comma in it
</SingleLineComment><SingleLineComment>Print @WorkingString
</SingleLineComment><SingleLineComment>Print patindex('%,%',@WorkingString)
</SingleLineComment><SingleLineComment> Inserting the string before the first comma
</SingleLineComment><Clause><OtherKeyword>Insert</OtherKeyword><WhiteSpace> </WhiteSpace><Other>#ValueTable</Other><DDLParens><Other>Id</Other></DDLParens><WhiteSpace>
</WhiteSpace></Clause><Clause><OtherKeyword>values</OtherKeyword><DDLParens><FunctionKeyword>substring</FunctionKeyword><FunctionParens><Other>@WorkingString</Other><Comma>,</Comma><NumberValue>1</NumberValue><Comma>,</Comma><FunctionKeyword>patindex</FunctionKeyword><FunctionParens><String>%,%</String><Comma>,</Comma><Other>@WorkingString</Other></FunctionParens><OtherOperator>-</OtherOperator><NumberValue>1</NumberValue></FunctionParens></DDLParens><WhiteSpace>
</WhiteSpace></Clause></SqlStatement><SqlStatement><SingleLineComment>resetting the temporary string to start after the first comma in the previous temp string
</SingleLineComment><Clause><OtherKeyword>select</OtherKeyword><WhiteSpace> </WhiteSpace><Other>@WorkingString</Other><WhiteSpace> </WhiteSpace><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><FunctionKeyword>substring</FunctionKeyword><FunctionParens><Other>@WorkingString</Other><Comma>,</Comma><FunctionKeyword>patindex</FunctionKeyword><FunctionParens><String>%,%</String><Comma>,</Comma><Other>@WorkingString</Other></FunctionParens><OtherOperator>+</OtherOperator><NumberValue>1</NumberValue><Comma>,</Comma><FunctionKeyword>Len</FunctionKeyword><FunctionParens><Other>@WorkingString</Other></FunctionParens></FunctionParens><WhiteSpace>
</WhiteSpace></Clause></SqlStatement><SqlStatement><SingleLineComment>Checking if there is no more commas 
</SingleLineComment><Clause><IfStatement><ContainerOpen><OtherKeyword>IF</OtherKeyword></ContainerOpen><BooleanExpression><WhiteSpace> </WhiteSpace><FunctionKeyword>patindex</FunctionKeyword><FunctionParens><String>%,%</String><Comma>,</Comma><Other>@WorkingString</Other></FunctionParens><OtherOperator>&lt;=</OtherOperator><NumberValue>0</NumberValue><WhiteSpace>
</WhiteSpace></BooleanExpression><ContainerSingleStatementBody><SqlStatement><Clause><BeginEndBlock><ContainerOpen><OtherKeyword>Begin</OtherKeyword></ContainerOpen><ContainerMultiStatementBody><SqlStatement><WhiteSpace>
</WhiteSpace><SingleLineComment>Inserting the last ID
</SingleLineComment><Clause><OtherKeyword>Insert</OtherKeyword><WhiteSpace> </WhiteSpace><Other>#ValueTable</Other><DDLParens><Other>Id</Other></DDLParens><WhiteSpace>
</WhiteSpace></Clause><Clause><OtherKeyword>values</OtherKeyword><DDLParens><Other>@WorkingString</Other></DDLParens><WhiteSpace>
</WhiteSpace></Clause></SqlStatement><SqlStatement><Clause><OtherKeyword>BREAK</OtherKeyword><WhiteSpace>
</WhiteSpace></Clause></SqlStatement></ContainerMultiStatementBody><ContainerClose><OtherKeyword>End</OtherKeyword></ContainerClose></BeginEndBlock><WhiteSpace>
</WhiteSpace></Clause></SqlStatement></ContainerSingleStatementBody><ElseClause><ContainerOpen><OtherKeyword>ELSE</OtherKeyword></ContainerOpen><ContainerSingleStatementBody><SqlStatement><WhiteSpace>
</WhiteSpace><Clause><OtherKeyword>CONTINUE</OtherKeyword><WhiteSpace>
</WhiteSpace></Clause></SqlStatement></ContainerSingleStatementBody></ElseClause></IfStatement></Clause></SqlStatement></ContainerMultiStatementBody><ContainerClose><OtherKeyword>END</OtherKeyword></ContainerClose></BeginEndBlock><WhiteSpace>

</WhiteSpace></Clause></SqlStatement></ContainerSingleStatementBody></WhileLoop></Clause></SqlStatement><SqlStatement><SingleLineComment> Getting the Employee Data
</SingleLineComment><Clause><OtherKeyword>select</OtherKeyword><WhiteSpace> </WhiteSpace><Asterisk>*</Asterisk><WhiteSpace>
</WhiteSpace></Clause><Clause><OtherKeyword>from</OtherKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>HumanResources</Other><Period>.</Period><Other>Employee</Other><WhiteSpace> </WhiteSpace><Other>e</Other><WhiteSpace>
</WhiteSpace></SelectionTarget></Clause><Clause><CompoundKeyword simpleText="JOIN"><OtherKeyword>join</OtherKeyword></CompoundKeyword><SelectionTarget><WhiteSpace> </WhiteSpace><Other>#ValueTable</Other><WhiteSpace> </WhiteSpace><Other>t</Other><WhiteSpace>
</WhiteSpace></SelectionTarget><JoinOn><ContainerOpen><OtherKeyword>on</OtherKeyword></ContainerOpen><ContainerContentBody><WhiteSpace> </WhiteSpace><FunctionKeyword>month</FunctionKeyword><FunctionParens><Other>e</Other><Period>.</Period><Other>BirthDate</Other></FunctionParens><EqualsSign>=</EqualsSign><WhiteSpace> </WhiteSpace><Other>t</Other><Period>.</Period><Other>Id</Other><WhiteSpace>

</WhiteSpace></ContainerContentBody></JoinOn></Clause></SqlStatement><SqlStatement><Clause><OtherKeyword>drop</OtherKeyword><WhiteSpace> </WhiteSpace><OtherKeyword>table</OtherKeyword><WhiteSpace> </WhiteSpace><Other>#ValueTable</Other><WhiteSpace> </WhiteSpace></Clause></SqlStatement></SqlRoot>